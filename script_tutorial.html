<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.632">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Peter Apicella">
<meta name="dcterms.date" content="2022-07-20">

<title>R Graphics and Statistics Tutorial Using Cannabis Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="script_tutorial_files/libs/clipboard/clipboard.min.js"></script>
<script src="script_tutorial_files/libs/quarto-html/quarto.js"></script>
<script src="script_tutorial_files/libs/quarto-html/popper.min.js"></script>
<script src="script_tutorial_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="script_tutorial_files/libs/quarto-html/anchor.min.js"></script>
<link href="script_tutorial_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="script_tutorial_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="script_tutorial_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="script_tutorial_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="script_tutorial_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet">

<script src="script_tutorial_files/libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="script_tutorial_files/libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="script_tutorial_files/libs/datatables-binding-0.23/datatables.js"></script>
<script src="script_tutorial_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="script_tutorial_files/libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="script_tutorial_files/libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="script_tutorial_files/libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="script_tutorial_files/libs/dt-ext-fixedcolumns-1.11.3/css/fixedColumns.dataTables.min.css" rel="stylesheet">
<script src="script_tutorial_files/libs/dt-ext-fixedcolumns-1.11.3/js/dataTables.fixedColumns.min.js"></script>
<link href="script_tutorial_files/libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="script_tutorial_files/libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>


</head>

<body>

<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">R Graphics and Statistics Tutorial Using Cannabis Data</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Peter Apicella </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">July 20, 2022</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"> <span class="header-section-number">1</span> Introduction</a>
  <ul class="collapse">
  <li><a href="#if-you-are-new-to-r-or-a-beginner-user" id="toc-if-you-are-new-to-r-or-a-beginner-user" class="nav-link" data-scroll-target="#if-you-are-new-to-r-or-a-beginner-user"> <span class="header-section-number">1.1</span> If you are new to R or a beginner user</a></li>
  </ul></li>
  <li><a href="#dual-axis-barline-graph" id="toc-dual-axis-barline-graph" class="nav-link" data-scroll-target="#dual-axis-barline-graph"> <span class="header-section-number">2</span> Dual axis bar/line graph</a></li>
  <li><a href="#analysis-of-variance" id="toc-analysis-of-variance" class="nav-link" data-scroll-target="#analysis-of-variance"> <span class="header-section-number">3</span> Analysis of variance</a></li>
  <li><a href="#boxplots" id="toc-boxplots" class="nav-link" data-scroll-target="#boxplots"> <span class="header-section-number">4</span> Boxplots</a></li>
  <li><a href="#pearsons-correlation-matrix" id="toc-pearsons-correlation-matrix" class="nav-link" data-scroll-target="#pearsons-correlation-matrix"> <span class="header-section-number">5</span> Pearson’s Correlation Matrix</a></li>
  <li><a href="#bar-plot-with-two-variables" id="toc-bar-plot-with-two-variables" class="nav-link" data-scroll-target="#bar-plot-with-two-variables"> <span class="header-section-number">6</span> Bar plot with two variables</a></li>
  <li><a href="#data-cleaning" id="toc-data-cleaning" class="nav-link" data-scroll-target="#data-cleaning"> <span class="header-section-number">7</span> Data cleaning</a></li>
  <li><a href="#line-graph" id="toc-line-graph" class="nav-link" data-scroll-target="#line-graph"> <span class="header-section-number">8</span> Line graph</a></li>
  <li><a href="#qpcr-data-analysis-in-r" id="toc-qpcr-data-analysis-in-r" class="nav-link" data-scroll-target="#qpcr-data-analysis-in-r"> <span class="header-section-number">9</span> qPCR data analysis in R</a></li>
  <li><a href="#session-information" id="toc-session-information" class="nav-link" data-scroll-target="#session-information"> <span class="header-section-number">10</span> Session information</a></li>
  </ul>
</nav>
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<ul>
<li>A major theme in the R statistics community is reproducibility.
<ul>
<li>Because many scientists build and use R, many are concerned about the reproducibility crisis in science.</li>
<li>Therefore, from one angle, the consensus from this community is to transparently share and publish data sources and analysis methodologies.</li>
<li>I wrote and compiled this document so that Berkowitz lab members (and perhaps others) not only may be able to reproduce the analyses that I did as a graduate student but also inherit what I learned.</li>
</ul></li>
<li>This document is meant to serve as a tutorial for reproducing the analyses that I have performed using the data that I have published.</li>
<li>Ideally after reading this document, a reader should be able to generate the same types of graphics and analyses using R on new data.</li>
<li>All data for the following sections are retrieved from my <a href="https://github.com/apicellap/data">github data repository</a>.</li>
<li>This document, which was built using Quarto (a type of markdown), initially runs the R code and prints the output per my instructions into an html format.
<ul>
<li>The grayed sections preceded and followed by (`) marks are known as code chunks.</li>
<li>Because these code chunks ran on my computer, they should work on any machine.
<ul>
<li>See the <a href="#session-information">Session information</a> section at the end of this document for R version information used to run initially create this document.</li>
</ul></li>
</ul></li>
<li>Additionally, if you would like to download the original scripts (.R documents), then you can go to my <a href="https://github.com/apicellap/UConn-code">UConn code repository</a>.
<ul>
<li>To efficiently download all the files, click on the green button which says “Code”.</li>
<li>Next, click “Download ZIP” and all the associated data files will download.</li>
<li>I categorize the files by which paper I used them for.
<ul>
<li>The HDG5 paper refers to the paper that Gang and I are working on (as of 7-19-22), but I may alter this directory name when the paper is eventually published.</li>
</ul></li>
</ul></li>
<li>Because these files are located on github, I am able to update the scripts as I see fit.
<ul>
<li>If you think there is some kind of code error, please let me know.</li>
</ul></li>
</ul>
<section id="if-you-are-new-to-r-or-a-beginner-user" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="if-you-are-new-to-r-or-a-beginner-user"><span class="header-section-number">1.1</span> If you are new to R or a beginner user</h2>
<ul>
<li>I would highly recommend reading <a href="https://www.amazon.com/Getting-Started-R-Introduction-Biologists/dp/0198787847/ref=sr_1_1?crid=3QEO7XZVHMGB9&amp;keywords=getting+started+with+r&amp;qid=1658338669&amp;sprefix=getting+started+with+%2Caps%2C219&amp;sr=8-1"><strong>Getting Started with R: An introduction for Biologists</strong></a>.
<ul>
<li>I read this last year as an intermediate-level R user and it hugely improved my skills.</li>
<li>I compiled my notes on it which can be found <a href="https://fluffy-sundae-7d21c8.netlify.app/">here</a>.</li>
</ul></li>
<li>Another beginner’s text is <a href="https://www.amazon.com/New-Statistics-Introduction-Biologists/dp/0198798180/ref=sr_1_1?crid=1W4IRA7HORZZ7&amp;keywords=the+new+statistics+with+r&amp;qid=1658338892&amp;sprefix=the+new+statistics+with+%2Caps%2C225&amp;sr=8-1"><strong>The New Statistics with R: An Introduction for Biologists</strong></a>
<ul>
<li>In this book, the author has fairly strong opinions against the ‘overuse’ of p-values and urges scientists to put more emphasis on confidence intervals and effect sizes in their work. It was very interesting.
<ul>
<li>I have also compiled my notes on this book in a document that can be found <a href="https://zingy-llama-670bfe.netlify.app">here</a>.</li>
</ul></li>
</ul></li>
<li>Additionally, one more text, which I haven’t read in its entirety is <a href="https://www.amazon.com/Action-Third-Robert-I-Kabacoff/dp/1617296058/ref=sr_1_1?crid=1J0LO2MKEAY9L&amp;keywords=r+in+action&amp;qid=1658339115&amp;sprefix=r+in+acti%2Caps%2C627&amp;sr=8-1"><strong>R in Action</strong></a>.
<ul>
<li>This book goes into much greater detail in certain advanced statistical methods that aren’t covered in the other two books.</li>
</ul></li>
<li>Lastly, whether you are new to R or not, I would highly recommend the use of Quarto (or its predecessor, Rmarkdown) to record the code that you eventually write in an easily transferable format.</li>
</ul>
</section>
</section>
<section id="dual-axis-barline-graph" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Dual axis bar/line graph</h1>
<p>Install packages:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"dplyr"</span>,<span class="at">repos =</span> <span class="st">"https://cran.us.r-project.org"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>,<span class="at">repos =</span> <span class="st">"https://cran.us.r-project.org"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>,<span class="at">repos =</span> <span class="st">"https://cran.us.r-project.org"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"magrittr"</span>,<span class="at">repos =</span> <span class="st">"https://cran.us.r-project.org"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Load package libraries:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Download data from github repository:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>urlfile1<span class="ot">=</span><span class="st">"https://raw.githubusercontent.com/apicellap/data/main/CtPharma_GG.csv"</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>gg_data<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="fu">url</span>(urlfile1)) <span class="co">#data from CtPharma Gorilla Glue (gene expression &amp; metabolite levels)</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>urlfile2<span class="ot">=</span><span class="st">"https://raw.githubusercontent.com/apicellap/data/main/CW_data_recalc-2.csv"</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>cw_data<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="fu">url</span>(urlfile2)) <span class="co">#data from Cherry Wine (gene expression &amp; metabolite levels)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>View ‘Cherry Wine’ dataframe:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(cw_data,<span class="at">extensions =</span> <span class="st">'FixedColumns'</span>,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">dom =</span> <span class="st">'t'</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">scrollX =</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fixedColumns =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div id="htmlwidget-c8379b2a679f4abdd319" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-c8379b2a679f4abdd319">{"x":{"filter":"none","vertical":false,"extensions":["FixedColumns"],"data":[["1","2","3","4","5","6","7"],[1,2,3,4,5,6,7],[1,1,0.2,0.8,16.8,6.5,3.3],[0.1,0.3,0.3,1.3,3.1,2.4,2.1],[1,0.5,1.3,4.3,1.7,1.1,0.471],[0.068837316,0.105844624,2.855713944,4.194804373,0.941273876,0.357714495,0],[1,0.5,0.7,1.4,5.5,2.8,4.2],[0.165688214,0.124443409,0.198636988,1.276925047,1.464643712,0.654181423,2.125040186],[1,0.4,0.4,1.3,4.3,7.6,6.5],[0.35,0.74,0.47,0.77,1.3,0.97,0],[1,1.5,1.1,0.4,4.1,2.8,0.4],[0.2,0.4,1.1,1.3,0.7,0.5,1.3],[1,0.4,0.8,1.9,4.8,3.7,4.9],[0.1,0,0.1,0.3,1,0.8,1.6],[1,0.6,0.6,0.5,4.5,5.6,1.6],[0.1,0.1,0.3,0.4,2,0.8,0.1],[1,1.3,1.3,0.7,7.7,4.5,0.3],[0.1,0.3,0.6,0.6,1.6,1.6,0.7],[0.1,0.2,0.1,0.4,0.5,0.7,0.8],[0,0,0.1,0,0.1,0,0.1],[0.1,0.2,0.2,0.2,0.3,0.3,0.4],[0,0,0,0,0,0,0],[0,0,0.04,0.142,0.096,0.02,0.133],[0,0,0.024,0.005,0.032,0.019,0.011],[3.2,6.3,4.5,9.4,13.8,18.8,21.5],[0.2,0.4,0.7,0.6,2,0.6,2],[1,1.7,2.7,2.2,4.3,3,3.1],[0.4,0.8,2.2,2.7,1.4,1.1,2.6],[0.2,0.4,1.1,1.3,0.7,0.5,1.5],[1,1.8,0.9,2.3,5.1,4.7,0.6],[0.4,0.4,0.6,0.6,1.2,2.4,0.4],[1,2.2,1.5,1.4,9.2,5.6,0.6],[0.4,0.3,0.9,0.8,1.7,2.3,0.5],[1,0.475337072,1.196633093,1.076573019,4.817344369,6.061136971,10.79982403],[0.18720207,0.239248656,0.375158794,0.462271562,1.229112912,0.343552088,4.333546199]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>week<\/th>\n      <th>CBCAS<\/th>\n      <th>CBCAS.se<\/th>\n      <th>PT4<\/th>\n      <th>PT4.se<\/th>\n      <th>PT1<\/th>\n      <th>PT1.se<\/th>\n      <th>THCAS<\/th>\n      <th>THCAS.se<\/th>\n      <th>HD1<\/th>\n      <th>HD1.se<\/th>\n      <th>CBDAS<\/th>\n      <th>CBDAS.se<\/th>\n      <th>TKS<\/th>\n      <th>TKS.se<\/th>\n      <th>GPPS<\/th>\n      <th>GPPS.se<\/th>\n      <th>THC<\/th>\n      <th>THC.se<\/th>\n      <th>CBC<\/th>\n      <th>CBC.se<\/th>\n      <th>CBG<\/th>\n      <th>CBG.se<\/th>\n      <th>CBD<\/th>\n      <th>CBD.se<\/th>\n      <th>HD1.1<\/th>\n      <th>HD1.sd<\/th>\n      <th>HD1.se.1<\/th>\n      <th>CAN738<\/th>\n      <th>CAN738.se<\/th>\n      <th>MIXTA<\/th>\n      <th>MIXTA.se<\/th>\n      <th>OAC<\/th>\n      <th>OAC.se<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","scrollX":true,"fixedColumns":true,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>View ‘Gorilla Glue’ dataframe:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(gg_data,<span class="at">extensions =</span> <span class="st">'FixedColumns'</span>,</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">dom =</span> <span class="st">'t'</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">scrollX =</span> <span class="cn">TRUE</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fixedColumns =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div id="htmlwidget-aca86e9b06caa17cfeda" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-aca86e9b06caa17cfeda">{"x":{"filter":"none","vertical":false,"extensions":["FixedColumns"],"data":[["1","2","3","4","5","6","7"],[1,2,3,4,5,6,7],[1,5.18,0.93,8.57,12.09,20.72,12.82],[2.7,11.93,0.7,2.63,0.79,2.97,0.37],[1,3.34,0.3,12.09,9.12,16.84,10.56],[2.72,2.38,0.82,2.77,1.28,3.55,0.82],[1,0.98,0.78,0.53,0.23,0.24,0.45],[0.007,0.099,0.187,0.057,0.103,0.196,0.08],[1,2.39,2.4,5.13,8.26,5.13,3.27],[0.01,0.66,0.35,1.06,2.66,0.78,1.13],[1,1.07,1.4,2.25,3.34,0.62,2.17],[0.12,0.04,1.52,0.61,1.46,0.1,0.14],[1,1.27,5.71,0.09,0.08,0.04,0.14],[0.43,2.18,1.56,0.02,0.03,0.06,0.15],[1,0.07,8.48,24.14,20.33,0.7,0.01],[0.63,0.29,5.53,11.46,4.34,0.0526,0.00025],[1,1.01,1.28,1.11,0.79,0.49,1.63],[0.14,0.05,0.97,0.22,0.16,0.06,0.15],[1,2.4,2.4,5.1,8.3,5.1,3.3],[0.01,0.66,0.35,1.06,2.66,0.78,1.13],[0.68,0.88,1.45,1.83,1.31,1.28,0.94],[0.09,0.13,0.07,0.11,0.11,0.04,0.05],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[1.15,4.85,8.73,16.85,21.48,23.25,20.58],[0.06,0.61,0.61,0.75,0.6,1.06,0.42],[1,16.81,4.92,34,32.59,64.38,294.61],[0.57,18.3,9.26,7.97,5.8,10.06,53.42]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>week<\/th>\n      <th>CBCAS<\/th>\n      <th>CBCAS.se<\/th>\n      <th>GPPS<\/th>\n      <th>GPPS.se<\/th>\n      <th>THCAS<\/th>\n      <th>THCAS.se<\/th>\n      <th>HD1<\/th>\n      <th>HD1.se<\/th>\n      <th>TKS<\/th>\n      <th>TKS.se<\/th>\n      <th>PT4<\/th>\n      <th>PT4.se<\/th>\n      <th>PT1<\/th>\n      <th>PT1.se<\/th>\n      <th>CBDAS<\/th>\n      <th>CBDAS.se<\/th>\n      <th>HD1.1<\/th>\n      <th>HD1.se.1<\/th>\n      <th>CBG<\/th>\n      <th>CBG.se<\/th>\n      <th>CBD<\/th>\n      <th>CBD.se<\/th>\n      <th>THC<\/th>\n      <th>THC.se<\/th>\n      <th>OAC<\/th>\n      <th>OAC.se<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","scrollX":true,"fixedColumns":true,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Manipulate dataframe variables (column names):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gg_data&lt;-gg_data %&gt;% rename_with( ~ paste0("GG.", .x)) #adds prefix to every column name in dataframe </span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># cw_data&lt;-cw_data %&gt;% rename_with( ~ paste0("CW.", .x)) </span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>gg_data<span class="ot">&lt;-</span><span class="fu">rename_with</span>(gg_data, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">"GG."</span>, .x)) <span class="co">#adds prefix to every column name in dataframe </span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>cw_data<span class="ot">&lt;-</span><span class="fu">rename_with</span>(cw_data, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">"CW."</span>, .x)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>View one of the updated dataframes:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(gg_data,<span class="at">extensions =</span> <span class="st">'FixedColumns'</span>,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">dom =</span> <span class="st">'t'</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">scrollX =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fixedColumns =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div id="htmlwidget-898b115c85ddc2a8529e" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-898b115c85ddc2a8529e">{"x":{"filter":"none","vertical":false,"extensions":["FixedColumns"],"data":[["1","2","3","4","5","6","7"],[1,2,3,4,5,6,7],[1,5.18,0.93,8.57,12.09,20.72,12.82],[2.7,11.93,0.7,2.63,0.79,2.97,0.37],[1,3.34,0.3,12.09,9.12,16.84,10.56],[2.72,2.38,0.82,2.77,1.28,3.55,0.82],[1,0.98,0.78,0.53,0.23,0.24,0.45],[0.007,0.099,0.187,0.057,0.103,0.196,0.08],[1,2.39,2.4,5.13,8.26,5.13,3.27],[0.01,0.66,0.35,1.06,2.66,0.78,1.13],[1,1.07,1.4,2.25,3.34,0.62,2.17],[0.12,0.04,1.52,0.61,1.46,0.1,0.14],[1,1.27,5.71,0.09,0.08,0.04,0.14],[0.43,2.18,1.56,0.02,0.03,0.06,0.15],[1,0.07,8.48,24.14,20.33,0.7,0.01],[0.63,0.29,5.53,11.46,4.34,0.0526,0.00025],[1,1.01,1.28,1.11,0.79,0.49,1.63],[0.14,0.05,0.97,0.22,0.16,0.06,0.15],[1,2.4,2.4,5.1,8.3,5.1,3.3],[0.01,0.66,0.35,1.06,2.66,0.78,1.13],[0.68,0.88,1.45,1.83,1.31,1.28,0.94],[0.09,0.13,0.07,0.11,0.11,0.04,0.05],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[1.15,4.85,8.73,16.85,21.48,23.25,20.58],[0.06,0.61,0.61,0.75,0.6,1.06,0.42],[1,16.81,4.92,34,32.59,64.38,294.61],[0.57,18.3,9.26,7.97,5.8,10.06,53.42]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>GG.week<\/th>\n      <th>GG.CBCAS<\/th>\n      <th>GG.CBCAS.se<\/th>\n      <th>GG.GPPS<\/th>\n      <th>GG.GPPS.se<\/th>\n      <th>GG.THCAS<\/th>\n      <th>GG.THCAS.se<\/th>\n      <th>GG.HD1<\/th>\n      <th>GG.HD1.se<\/th>\n      <th>GG.TKS<\/th>\n      <th>GG.TKS.se<\/th>\n      <th>GG.PT4<\/th>\n      <th>GG.PT4.se<\/th>\n      <th>GG.PT1<\/th>\n      <th>GG.PT1.se<\/th>\n      <th>GG.CBDAS<\/th>\n      <th>GG.CBDAS.se<\/th>\n      <th>GG.HD1.1<\/th>\n      <th>GG.HD1.se.1<\/th>\n      <th>GG.CBG<\/th>\n      <th>GG.CBG.se<\/th>\n      <th>GG.CBD<\/th>\n      <th>GG.CBD.se<\/th>\n      <th>GG.THC<\/th>\n      <th>GG.THC.se<\/th>\n      <th>GG.OAC<\/th>\n      <th>GG.OAC.se<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","scrollX":true,"fixedColumns":true,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Modify variable representing week in each dataframe to become identical:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(gg_data)[<span class="fu">names</span>(gg_data) <span class="sc">==</span> <span class="st">'GG.week'</span>] <span class="ot">&lt;-</span> <span class="st">'week'</span> <span class="co">#changes name of variable</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cw_data)[<span class="fu">names</span>(cw_data) <span class="sc">==</span> <span class="st">'CW.week'</span>] <span class="ot">&lt;-</span> <span class="st">'week'</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">intersect</span>(<span class="fu">names</span>(gg_data), <span class="fu">names</span>(cw_data)) <span class="co"># print common variable among included dataframes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "week"</code></pre>
</div>
</div>
<p>Link the two dataframes into one new dataframe:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>GG.CW<span class="ot">=</span><span class="fu">full_join</span>(gg_data, cw_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining, by = "week"</code></pre>
</div>
</div>
<p>View the new dataframe:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(GG.CW,<span class="at">extensions =</span> <span class="st">'FixedColumns'</span>,</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">dom =</span> <span class="st">'t'</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">scrollX =</span> <span class="cn">TRUE</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fixedColumns =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div id="htmlwidget-99a598a5f66c9fd6adc3" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-99a598a5f66c9fd6adc3">{"x":{"filter":"none","vertical":false,"extensions":["FixedColumns"],"data":[["1","2","3","4","5","6","7"],[1,2,3,4,5,6,7],[1,5.18,0.93,8.57,12.09,20.72,12.82],[2.7,11.93,0.7,2.63,0.79,2.97,0.37],[1,3.34,0.3,12.09,9.12,16.84,10.56],[2.72,2.38,0.82,2.77,1.28,3.55,0.82],[1,0.98,0.78,0.53,0.23,0.24,0.45],[0.007,0.099,0.187,0.057,0.103,0.196,0.08],[1,2.39,2.4,5.13,8.26,5.13,3.27],[0.01,0.66,0.35,1.06,2.66,0.78,1.13],[1,1.07,1.4,2.25,3.34,0.62,2.17],[0.12,0.04,1.52,0.61,1.46,0.1,0.14],[1,1.27,5.71,0.09,0.08,0.04,0.14],[0.43,2.18,1.56,0.02,0.03,0.06,0.15],[1,0.07,8.48,24.14,20.33,0.7,0.01],[0.63,0.29,5.53,11.46,4.34,0.0526,0.00025],[1,1.01,1.28,1.11,0.79,0.49,1.63],[0.14,0.05,0.97,0.22,0.16,0.06,0.15],[1,2.4,2.4,5.1,8.3,5.1,3.3],[0.01,0.66,0.35,1.06,2.66,0.78,1.13],[0.68,0.88,1.45,1.83,1.31,1.28,0.94],[0.09,0.13,0.07,0.11,0.11,0.04,0.05],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[1.15,4.85,8.73,16.85,21.48,23.25,20.58],[0.06,0.61,0.61,0.75,0.6,1.06,0.42],[1,16.81,4.92,34,32.59,64.38,294.61],[0.57,18.3,9.26,7.97,5.8,10.06,53.42],[1,1,0.2,0.8,16.8,6.5,3.3],[0.1,0.3,0.3,1.3,3.1,2.4,2.1],[1,0.5,1.3,4.3,1.7,1.1,0.471],[0.068837316,0.105844624,2.855713944,4.194804373,0.941273876,0.357714495,0],[1,0.5,0.7,1.4,5.5,2.8,4.2],[0.165688214,0.124443409,0.198636988,1.276925047,1.464643712,0.654181423,2.125040186],[1,0.4,0.4,1.3,4.3,7.6,6.5],[0.35,0.74,0.47,0.77,1.3,0.97,0],[1,1.5,1.1,0.4,4.1,2.8,0.4],[0.2,0.4,1.1,1.3,0.7,0.5,1.3],[1,0.4,0.8,1.9,4.8,3.7,4.9],[0.1,0,0.1,0.3,1,0.8,1.6],[1,0.6,0.6,0.5,4.5,5.6,1.6],[0.1,0.1,0.3,0.4,2,0.8,0.1],[1,1.3,1.3,0.7,7.7,4.5,0.3],[0.1,0.3,0.6,0.6,1.6,1.6,0.7],[0.1,0.2,0.1,0.4,0.5,0.7,0.8],[0,0,0.1,0,0.1,0,0.1],[0.1,0.2,0.2,0.2,0.3,0.3,0.4],[0,0,0,0,0,0,0],[0,0,0.04,0.142,0.096,0.02,0.133],[0,0,0.024,0.005,0.032,0.019,0.011],[3.2,6.3,4.5,9.4,13.8,18.8,21.5],[0.2,0.4,0.7,0.6,2,0.6,2],[1,1.7,2.7,2.2,4.3,3,3.1],[0.4,0.8,2.2,2.7,1.4,1.1,2.6],[0.2,0.4,1.1,1.3,0.7,0.5,1.5],[1,1.8,0.9,2.3,5.1,4.7,0.6],[0.4,0.4,0.6,0.6,1.2,2.4,0.4],[1,2.2,1.5,1.4,9.2,5.6,0.6],[0.4,0.3,0.9,0.8,1.7,2.3,0.5],[1,0.475337072,1.196633093,1.076573019,4.817344369,6.061136971,10.79982403],[0.18720207,0.239248656,0.375158794,0.462271562,1.229112912,0.343552088,4.333546199]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>week<\/th>\n      <th>GG.CBCAS<\/th>\n      <th>GG.CBCAS.se<\/th>\n      <th>GG.GPPS<\/th>\n      <th>GG.GPPS.se<\/th>\n      <th>GG.THCAS<\/th>\n      <th>GG.THCAS.se<\/th>\n      <th>GG.HD1<\/th>\n      <th>GG.HD1.se<\/th>\n      <th>GG.TKS<\/th>\n      <th>GG.TKS.se<\/th>\n      <th>GG.PT4<\/th>\n      <th>GG.PT4.se<\/th>\n      <th>GG.PT1<\/th>\n      <th>GG.PT1.se<\/th>\n      <th>GG.CBDAS<\/th>\n      <th>GG.CBDAS.se<\/th>\n      <th>GG.HD1.1<\/th>\n      <th>GG.HD1.se.1<\/th>\n      <th>GG.CBG<\/th>\n      <th>GG.CBG.se<\/th>\n      <th>GG.CBD<\/th>\n      <th>GG.CBD.se<\/th>\n      <th>GG.THC<\/th>\n      <th>GG.THC.se<\/th>\n      <th>GG.OAC<\/th>\n      <th>GG.OAC.se<\/th>\n      <th>CW.CBCAS<\/th>\n      <th>CW.CBCAS.se<\/th>\n      <th>CW.PT4<\/th>\n      <th>CW.PT4.se<\/th>\n      <th>CW.PT1<\/th>\n      <th>CW.PT1.se<\/th>\n      <th>CW.THCAS<\/th>\n      <th>CW.THCAS.se<\/th>\n      <th>CW.HD1<\/th>\n      <th>CW.HD1.se<\/th>\n      <th>CW.CBDAS<\/th>\n      <th>CW.CBDAS.se<\/th>\n      <th>CW.TKS<\/th>\n      <th>CW.TKS.se<\/th>\n      <th>CW.GPPS<\/th>\n      <th>CW.GPPS.se<\/th>\n      <th>CW.THC<\/th>\n      <th>CW.THC.se<\/th>\n      <th>CW.CBC<\/th>\n      <th>CW.CBC.se<\/th>\n      <th>CW.CBG<\/th>\n      <th>CW.CBG.se<\/th>\n      <th>CW.CBD<\/th>\n      <th>CW.CBD.se<\/th>\n      <th>CW.HD1.1<\/th>\n      <th>CW.HD1.sd<\/th>\n      <th>CW.HD1.se.1<\/th>\n      <th>CW.CAN738<\/th>\n      <th>CW.CAN738.se<\/th>\n      <th>CW.MIXTA<\/th>\n      <th>CW.MIXTA.se<\/th>\n      <th>CW.OAC<\/th>\n      <th>CW.OAC.se<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","scrollX":true,"fixedColumns":true,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Create objects to take on expressions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>Prim.y_title<span class="fl">.001</span> <span class="ot">&lt;-</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Relative expression of "</span>, <span class="fu">italic</span>(<span class="st">"PT4"</span>)))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>ggtitle<span class="fl">.001</span> <span class="ot">&lt;-</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"PT4"</span>), <span class="st">" expression vs. CBG content in GG"</span>))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>ggtitle<span class="fl">.002</span> <span class="ot">&lt;-</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"PT4"</span>), <span class="st">" expression"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Plot gene expression in bar chart superimposed with a line graph of the metabolite data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>GG.CBG.PT4<span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="at">data=</span>GG.CW) <span class="sc">+</span> <span class="co">#use dataframe 'GG.CW' in ggplot function </span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x=</span>week, <span class="at">y=</span>GG.PT4), <span class="co">#geom_bar inherits the dataframe GG.CW </span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">stat=</span><span class="st">"identity"</span>,      <span class="co">#prevents R from doing new calculations on the data and just present them as they are </span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill=</span><span class="st">"#ba5b2f"</span>, <span class="co">#color of the fill of the bar - this is a hexcode </span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"#6b3d25"</span>, <span class="co">#color of the outline of the bar </span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="co">#thickness of the outline</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">x=</span>week, <span class="co">#argument is for standard error for the bar chart </span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymin=</span>GG.PT4 <span class="sc">*</span><span class="dv">1</span> <span class="sc">-</span>GG.PT4.se <span class="sc">*</span><span class="dv">1</span>, <span class="co">#minimum for the standard error</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax=</span>GG.PT4<span class="sc">*</span><span class="dv">1</span>, <span class="co">#No error bar in the positive direction </span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">width=</span>.<span class="dv">2</span>), <span class="co">#width of the error bar</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>), </span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"#6b3d25"</span>, <span class="co">#color of the error bars</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">size=</span><span class="fl">1.0</span>, <span class="co">#size of the error bar </span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">linetype =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="co">#line style for error bar</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>week, <span class="co">#the line for the metabolite data (total CBG in this case)</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">y=</span>GG.CBG<span class="sc">*</span>(<span class="dv">4</span>), <span class="co">#the scale on the y axis is multiplied by 4 </span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">group=</span><span class="dv">1</span>), </span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span> <span class="co">#thickness of the line</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">x=</span>week, <span class="co">#error bars for the line </span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymin=</span>GG.CBG <span class="sc">*</span><span class="dv">4</span>, <span class="co">#this set of error bars does not have a bar in the negative direction</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax=</span>GG.CBG <span class="sc">*</span><span class="dv">4</span> <span class="sc">+</span>GG.CBG.se <span class="sc">*</span><span class="dv">4</span>, </span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">width=</span>.<span class="dv">2</span>),</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size=</span><span class="fl">1.0</span>, <span class="at">linetype =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">2.75</span>, <span class="co">#size of the data point on the graph </span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span>week, <span class="at">y=</span>GG.CBG<span class="sc">*</span>(<span class="dv">4</span>), </span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>                 <span class="at">group=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">name =</span><span class="st">"Week"</span>, <span class="at">limits=</span><span class="fu">c</span>(<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>, <span class="st">"4"</span>, <span class="st">"5"</span>, <span class="st">"6"</span>, <span class="st">"7"</span>)) <span class="sc">+</span> <span class="co">#Program the exact x axis labels </span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>( <span class="co">#program the y axis ticks  </span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">8</span>), <span class="co">#y axis range</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>), <span class="co">#tick marks labeled on y axis </span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">name=</span> Prim.y_title<span class="fl">.001</span>, <span class="co">#left hand y axis label </span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span> . <span class="sc">*</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>), <span class="co">#right hand (secondary) y axis scale is reduced by a factor or 0.25</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>                        <span class="at">name=</span><span class="st">"CBG content (% dry weight)"</span>)) <span class="sc">+</span> <span class="co">#secondary y axis label </span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.y.right =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>), <span class="co">#theme elements are pretty self explanatory </span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y.right =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">18</span>),</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y.right =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">18</span>),</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y.left =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y.left =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#6b3d25"</span>, <span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">18</span>),</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y.left =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#6b3d25"</span>, <span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size =</span><span class="dv">18</span>),</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">18</span>),</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.length =</span> <span class="fu">unit</span>(<span class="sc">-</span><span class="fl">0.25</span>, <span class="st">"cm"</span>),</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x=</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>,<span class="at">size=</span><span class="dv">18</span>)) <span class="sc">+</span></span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill=</span><span class="cn">NA</span>, <span class="at">size=</span><span class="dv">1</span>),</span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(ggtitle<span class="fl">.001</span>) <span class="sc">+</span></span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">19</span>)) <span class="sc">+</span></span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Weeks after Flower Initiation"</span>) <span class="sc">+</span></span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span> </span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="co">#annotate plot with text </span></span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">2</span>, <span class="co">#x coordinate for annotation </span></span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="dv">4</span>, <span class="co">#y coordinate for annotation </span></span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">""</span>, <span class="co">#inscription for the annotation</span></span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">8</span>,  <span class="co">#font size </span></span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"#6b3d25"</span>) <span class="sc">+</span> <span class="co">#color of the annotation</span></span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="fl">6.5</span>, <span class="at">label =</span> <span class="st">"*"</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">"#6b3d25"</span>) <span class="sc">+</span></span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">4</span>, <span class="at">y =</span> .<span class="dv">5</span>, <span class="at">label =</span> <span class="st">""</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">"#6b3d25"</span>) <span class="sc">+</span></span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">5</span>, <span class="at">y =</span> .<span class="dv">5</span>, <span class="at">label =</span> <span class="st">""</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">"#6b3d25"</span>) <span class="sc">+</span></span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">6</span>, <span class="at">y =</span>.<span class="dv">51</span>, <span class="at">label =</span> <span class="st">""</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">"#6b3d25"</span>) <span class="sc">+</span></span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">7</span>, <span class="at">y =</span> <span class="dv">1</span>, <span class="at">label =</span> <span class="st">""</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">"#6b3d25"</span>)</span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a>GG.CBG.PT4 <span class="co">#call the name of the plot again to print it </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="script_tutorial_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>#Bar chart without the line superimposed:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>GG.CBG.PT4<span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="at">data=</span>GG.CW) <span class="sc">+</span> <span class="co">#use dataframe 'GG.CW' in ggplot function </span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x=</span>week, <span class="at">y=</span>GG.PT4), <span class="co">#geom_bar inherits the dataframe GG.CW </span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">stat=</span><span class="st">"identity"</span>,      <span class="co">#prevents R from doing new calculations on the data and just present them as they are </span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill=</span><span class="st">"#ba5b2f"</span>, <span class="co">#color of the fill of the bar - this is a hexcode </span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"#6b3d25"</span>, <span class="co">#color of the outline of the bar </span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="co">#thickness of the outline</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">x=</span>week, <span class="co">#argument is for standard error for the bar chart </span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymin=</span>GG.PT4 <span class="sc">*</span><span class="dv">1</span> <span class="sc">-</span>GG.PT4.se <span class="sc">*</span><span class="dv">1</span>, <span class="co">#minimum for the standard error</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax=</span>GG.PT4<span class="sc">*</span><span class="dv">1</span>, <span class="co">#No error bar in the positive direction </span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">width=</span>.<span class="dv">2</span>), <span class="co">#width of the error bar</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>), </span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"#6b3d25"</span>, <span class="co">#color of the error bars</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">size=</span><span class="fl">1.0</span>, <span class="co">#size of the error bar </span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">linetype =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="co">#line style for error bar</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">name =</span><span class="st">"Week"</span>, <span class="at">limits=</span><span class="fu">c</span>(<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>, <span class="st">"4"</span>, <span class="st">"5"</span>, <span class="st">"6"</span>, <span class="st">"7"</span>)) <span class="sc">+</span> <span class="co">#Program the exact x axis labels </span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>( <span class="co">#program the y axis ticks  </span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">8</span>), <span class="co">#y axis range</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>), <span class="co">#tick marks labeled on y axis </span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">name=</span> Prim.y_title<span class="fl">.001</span>) <span class="sc">+</span> <span class="co">#left hand y axis label </span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.line.y.right =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>), <span class="co">#theme elements are pretty self explanatory </span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y.right =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">18</span>),</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y.right =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">18</span>),</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y.left =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y.left =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#6b3d25"</span>, <span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">18</span>),</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y.left =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#6b3d25"</span>, <span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size =</span><span class="dv">18</span>),</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">18</span>),</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.length =</span> <span class="fu">unit</span>(<span class="sc">-</span><span class="fl">0.25</span>, <span class="st">"cm"</span>),</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x=</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>,<span class="at">size=</span><span class="dv">18</span>)) <span class="sc">+</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill=</span><span class="cn">NA</span>, <span class="at">size=</span><span class="dv">1</span>),</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(ggtitle<span class="fl">.002</span>) <span class="sc">+</span></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">19</span>)) <span class="sc">+</span></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Weeks after Flower Initiation"</span>) <span class="sc">+</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span> </span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="co">#annotate plot with text </span></span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">2</span>, <span class="co">#x coordinate for annotation </span></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="dv">4</span>, <span class="co">#y coordinate for annotation </span></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">""</span>, <span class="co">#inscription for the annotation</span></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">8</span>,  <span class="co">#font size </span></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"#6b3d25"</span>) <span class="sc">+</span> <span class="co">#color of the annotation</span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="fl">6.5</span>, <span class="at">label =</span> <span class="st">"*"</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">"#6b3d25"</span>) <span class="sc">+</span></span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">4</span>, <span class="at">y =</span> .<span class="dv">5</span>, <span class="at">label =</span> <span class="st">""</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">"#6b3d25"</span>) <span class="sc">+</span></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">5</span>, <span class="at">y =</span> .<span class="dv">5</span>, <span class="at">label =</span> <span class="st">""</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">"#6b3d25"</span>) <span class="sc">+</span></span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">6</span>, <span class="at">y =</span>.<span class="dv">51</span>, <span class="at">label =</span> <span class="st">""</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">"#6b3d25"</span>) <span class="sc">+</span></span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">7</span>, <span class="at">y =</span> <span class="dv">1</span>, <span class="at">label =</span> <span class="st">""</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">"#6b3d25"</span>)</span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>GG.CBG.PT4 <span class="co">#call the name of the plot again to print it </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="script_tutorial_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="analysis-of-variance" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Analysis of variance</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"agricolae"</span>,<span class="at">repos =</span> <span class="st">"https://cran.us.r-project.org"</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"ggfortify"</span>,<span class="at">repos =</span> <span class="st">"https://cran.us.r-project.org"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Download data from the CtPharma experiment with methyl jasmonate applications on ‘White Tangy Haze’ plants:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>urlfile3<span class="ot">=</span><span class="st">"https://raw.githubusercontent.com/apicellap/data/main/CtPharma_dwt.csv"</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>MJ<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="fu">url</span>(urlfile3))</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(MJ) <span class="co">#print column names (variables)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ID"     "SAMPLE" "X.DWT"  "CONC"   "METAB"  "WEEK"  </code></pre>
</div>
</div>
<p>Modify name of one variable for percent weight of metabolite:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(MJ)[<span class="fu">names</span>(MJ) <span class="sc">==</span> <span class="st">'X.DWT'</span>] <span class="ot">&lt;-</span> <span class="st">'perc.dwt'</span> <span class="co">#changes name of variable</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(MJ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ID"       "SAMPLE"   "perc.dwt" "CONC"     "METAB"    "WEEK"    </code></pre>
</div>
</div>
<p>Create new column to encompass decimal form of percentage:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>MJ<span class="sc">$</span>dec.dwt <span class="ot">&lt;-</span> (MJ<span class="sc">$</span>perc.dwt<span class="sc">/</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Arcsin transformation of decimal-form data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>MJ<span class="sc">$</span>ASin <span class="ot">&lt;-</span><span class="fu">asin</span>(<span class="fu">sqrt</span>(MJ<span class="sc">$</span>dec.dwt))</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(MJ) <span class="co">#display top six rows of the dataframe</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ID SAMPLE perc.dwt CONC METAB WEEK    dec.dwt      ASin
1  1  10-1A 2.581322    0   THC    1 0.02581322 0.1613643
2  2  10-2A 2.456230    0   THC    1 0.02456230 0.1573724
3  3  10-3A 2.331155    0   THC    1 0.02331155 0.1532807
4  4  11-1A 2.311758    0   THC    1 0.02311758 0.1526367
5  5  11-2A 2.333276    0   THC    1 0.02333276 0.1533510
6  6  11-3A 2.683677    0   THC    1 0.02683677 0.1645610</code></pre>
</div>
</div>
<p>Subset data into further subsetted dataframes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>THC <span class="ot">&lt;-</span> <span class="fu">subset</span>(MJ, METAB<span class="sc">==</span><span class="st">"THC"</span>) <span class="co">#create new dataframe, THC, when METAB is THC </span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>THC_wk1 <span class="ot">&lt;-</span> <span class="fu">subset</span>(THC, WEEK<span class="sc">==</span><span class="st">"1"</span>) <span class="co">#subset the THC dataframe into new dataframe to isolate the timeframe </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Create model and perform ANOVA:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(ASin <span class="sc">~</span> CONC, THC_wk1) <span class="co">#create linear model of the data (one way ANOVA design)</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1) <span class="co">#perform ANOVA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = ASin ~ CONC, data = THC_wk1)

Residuals:
       Min         1Q     Median         3Q        Max 
-0.0142617 -0.0049097 -0.0004251  0.0037375  0.0220615 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 1.548e-01  1.760e-03   87.94  &lt; 2e-16 ***
CONC        1.013e-05  3.136e-06    3.23  0.00274 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.007409 on 34 degrees of freedom
Multiple R-squared:  0.2349,    Adjusted R-squared:  0.2123 
F-statistic: 10.44 on 1 and 34 DF,  p-value: 0.002742</code></pre>
</div>
</div>
<p>Check assumption that the data are normally distributed:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>MJ<span class="sc">$</span>CONC <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(MJ<span class="sc">$</span>CONC)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(mod1, <span class="at">which =</span> <span class="fu">c</span>(<span class="dv">2</span>), <span class="at">ncol=</span><span class="dv">1</span>, <span class="at">smooth.colour =</span> <span class="cn">NA</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="script_tutorial_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The assumption of normality appears to be met</p>
<p>Check assumption of equal variance (among groups):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(mod1, <span class="at">which =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="at">ncol=</span><span class="dv">2</span>, <span class="at">smooth.colour =</span> <span class="cn">NA</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 36 row(s) containing missing values (geom_path).
Removed 36 row(s) containing missing values (geom_path).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="script_tutorial_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This assumption appears to be met.</p>
<p>Perform Fisher’s LSD test:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>lsd1 <span class="ot">&lt;-</span> <span class="fu">LSD.test</span>(mod1, <span class="st">"CONC"</span>, <span class="at">group=</span><span class="cn">TRUE</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>lsd1 <span class="co">#see $groups section </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$statistics
       MSerror Df      Mean      CV  t.value         LSD
  5.488752e-05 34 0.1588556 4.66374 2.032245 0.007097518

$parameters
        test p.ajusted name.t ntr alpha
  Fisher-LSD      none   CONC   4  0.05

$means
          ASin         std r       LCL       UCL       Min       Max       Q25
0    0.1593182 0.007656683 9 0.1542995 0.1643369 0.1526367 0.1768644 0.1533510
100  0.1534571 0.005211354 9 0.1484384 0.1584758 0.1469889 0.1631459 0.1495377
500  0.1550842 0.007421761 9 0.1500655 0.1601029 0.1456070 0.1690349 0.1492697
1000 0.1675628 0.005448446 9 0.1625441 0.1725815 0.1567742 0.1743687 0.1646615
           Q50       Q75
0    0.1573724 0.1613643
100  0.1537304 0.1565335
500  0.1551142 0.1592098
1000 0.1684787 0.1701574

$comparison
NULL

$groups
          ASin groups
1000 0.1675628      a
0    0.1593182      b
500  0.1550842      b
100  0.1534571      b

attr(,"class")
[1] "group"</code></pre>
</div>
</div>
<p>Housekeeping for dataframes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>lsd_thc.wk1 <span class="ot">&lt;-</span> lsd1<span class="sc">$</span>groups <span class="co">#create new dataframe that encapsulates the LSD output </span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>CONC <span class="ot">&lt;-</span> <span class="fu">as.list</span>(<span class="fu">c</span>(<span class="dv">1000</span>,<span class="dv">0</span>,<span class="dv">500</span>,<span class="dv">100</span>)) </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>lsd_thc.wk1<span class="sc">$</span>CONC <span class="ot">&lt;-</span> CONC <span class="co">#create new column that will inherit the list, 'CONC' </span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>lsd_thc.wk1<span class="sc">$</span>CONC <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(lsd_thc.wk1<span class="sc">$</span>CONC) <span class="co">#coerce the variable CONC to be numeric so that it can be sorted numerically</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>lsd_thc.wk1 <span class="ot">&lt;-</span> <span class="fu">arrange</span>(lsd_thc.wk1, CONC) <span class="co">#arrange the dataframe by CONC by least to greatest value </span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>lsd_thc.wk1 <span class="sc">%&gt;%</span> <span class="fu">mutate_if</span>(is.character, str_to_upper) <span class="ot">-&gt;</span> lsd_thc.wk1 <span class="co">#change any character in the dataframe to uppercase </span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>lsd_thc.wk1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          ASin groups CONC
0    0.1593182      B    0
100  0.1534571      B  100
500  0.1550842      B  500
1000 0.1675628      A 1000</code></pre>
</div>
</div>
</section>
<section id="boxplots" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Boxplots</h1>
<p>This section aims to plot the metabolite (in this case, THC) data in boxplots together with the Fisher’s LSD output from the model, mod1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"ggpubr"</span>,<span class="at">repos =</span> <span class="st">"https://cran.us.r-project.org"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Create some objects to feed into code for the boxplot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>,<span class="st">"#E7B800"</span>, <span class="st">"#808080"</span>, <span class="st">"#FC4E07"</span>) <span class="co">#hexcodes for colors of boxplots</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(colors) <span class="ot">=</span> <span class="fu">unique</span>(THC_wk1<span class="sc">$</span>CONC) <span class="co">#gives names to the colors </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>w1THC <span class="ot">&lt;-</span><span class="fu">ggboxplot</span>(THC_wk1, <span class="at">x =</span> <span class="st">"CONC"</span>, <span class="at">y =</span> <span class="st">"perc.dwt"</span>, </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> <span class="st">"CONC"</span>, <span class="co">#assign colors to the CONC variable</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">palette =</span> colors, <span class="co">#use the object created in the previous code chunk</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">add =</span> <span class="st">"jitter"</span>, <span class="co">#adds random noise into the datapoints so that they disperse randomly </span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">xlab =</span> <span class="st">"Concentration of MeJA (µM)"</span> , </span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylab =</span> <span class="st">"THC content (% dry weight)"</span>,</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">title =</span> <span class="st">"Week 1"</span>,</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="fl">3.5</span>), <span class="co">#y axis range</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">yticks.by =</span> <span class="fl">0.25</span>, <span class="co">#y axis tick increment</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">legend.title =</span> <span class="st">"Concentration (µM)"</span>) <span class="sc">+</span>  <span class="fu">rremove</span>(<span class="st">"legend"</span>) <span class="sc">+</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span> <span class="dv">14</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">family =</span> <span class="st">"Arial"</span>, <span class="at">face =</span> <span class="st">"bold"</span>)) <span class="sc">+</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill=</span><span class="cn">NA</span>, <span class="at">size=</span><span class="fl">1.5</span>),</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.length =</span> <span class="fu">unit</span>(<span class="sc">-</span><span class="fl">0.25</span>, <span class="st">"cm"</span>),</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.y.left =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y.left =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">family =</span> <span class="st">"Arial"</span>),</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y.left =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">family =</span> <span class="st">"Arial"</span>,<span class="at">margin=</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>), <span class="st">"cm"</span>)),</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">family =</span> <span class="st">"Arial"</span>, <span class="at">margin=</span><span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>), <span class="st">"cm"</span>)),</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x=</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">face=</span><span class="st">"bold"</span>,<span class="at">size =</span> <span class="dv">16</span>, <span class="at">family =</span> <span class="st">"Arial"</span>)) <span class="sc">+</span> </span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a><span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="co">#annotate the plot with text</span></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="co">#respective x coordinate for each label </span></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="fu">c</span>(<span class="fl">3.25</span>,<span class="fl">2.8</span>,<span class="dv">3</span>,<span class="fl">3.2</span>), <span class="co">#respective y coordinate for each label</span></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> lsd_thc.wk1<span class="sc">$</span>groups, <span class="co">#list of labels to corresponding to x positions 1:4 </span></span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">size =</span> <span class="dv">6</span>, <span class="co">#font size </span></span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">fontface =</span> <span class="st">"bold"</span>)</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>w1THC</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="script_tutorial_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("THC-plot.jpeg", device = "jpeg", units="in", width=6, height=5, dpi=300) - code for saving the plot </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pearsons-correlation-matrix" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Pearson’s Correlation Matrix</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"corrplot"</span>,<span class="at">repos =</span> <span class="st">"https://cran.us.r-project.org"</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"Hmisc"</span>,<span class="at">repos =</span> <span class="st">"https://cran.us.r-project.org"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Download gene expression and metabolite data for the CtPharma experiment on ‘Gorilla Glue’ (GG):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>urlfile4<span class="ot">=</span><span class="st">"https://raw.githubusercontent.com/apicellap/data/main/CtPharma_age_corr.csv"</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>GG_mat<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="fu">url</span>(urlfile4)) <span class="co">#data from CtPharma Gorilla Glue (gene expression &amp; metabolite levels)</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(GG_mat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  week CBCAS  GPPS THCAS HDG5  OAC   PT1        PT4 CBDAS  CBG      THC
1    1  1.00  1.00  1.00 1.00 1.00  1.00 1.00000000  1.00 0.50  2.10000
2    2  5.18  3.34  0.98 2.39 1.07  0.07 1.26605554  1.01 0.86  4.40000
3    3  0.93  0.30  0.78 2.40 1.40  8.48 5.71349323  1.28 1.45  8.73250
4    4  8.57 12.09  0.53 5.13 2.25 24.14 0.08681681  1.11 1.80 16.56500
5    5 12.09  9.12  0.23 8.26 3.34 20.33 0.08384901  0.79 1.31 21.47750
6    6 20.72 16.84  0.24 5.13 0.62  0.12 0.04156684  0.49 1.28 23.24841</code></pre>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Data in this dataframe were pre-calculated in excel when I was a graduate student. However, the general rule of thumb is to input the original dataframe into R and perform all data wrangling and calculations through code.</p>
</div>
</div>
<p>Dataframe modifications:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(GG_mat)[<span class="fu">names</span>(GG_mat) <span class="sc">==</span> <span class="st">'THC'</span>] <span class="ot">&lt;-</span> <span class="st">'perc.THC'</span> <span class="co">#changes name of variable</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(GG_mat)[<span class="fu">names</span>(GG_mat) <span class="sc">==</span> <span class="st">'CBG'</span>] <span class="ot">&lt;-</span> <span class="st">'perc.CBG'</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>GG_mat<span class="sc">$</span>dec.THC <span class="ot">&lt;-</span> (GG_mat<span class="sc">$</span>perc.THC<span class="sc">/</span><span class="dv">100</span>) <span class="co">#creates new column where percentage is converted to decimal</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>GG_mat<span class="sc">$</span>dec.CBG <span class="ot">&lt;-</span> (GG_mat<span class="sc">$</span>perc.CBG<span class="sc">/</span><span class="dv">100</span>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>GG_mat<span class="sc">$</span>THC <span class="ot">&lt;-</span><span class="fu">asin</span>(<span class="fu">sqrt</span>(GG_mat<span class="sc">$</span>dec.THC)) <span class="co">#arcsin transformation calculation</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>GG_mat<span class="sc">$</span>CBG<span class="ot">&lt;-</span><span class="fu">asin</span>(<span class="fu">sqrt</span>(GG_mat<span class="sc">$</span>dec.CBG))</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(GG_mat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  week CBCAS  GPPS THCAS HDG5  OAC   PT1        PT4 CBDAS perc.CBG perc.THC
1    1  1.00  1.00  1.00 1.00 1.00  1.00 1.00000000  1.00     0.50  2.10000
2    2  5.18  3.34  0.98 2.39 1.07  0.07 1.26605554  1.01     0.86  4.40000
3    3  0.93  0.30  0.78 2.40 1.40  8.48 5.71349323  1.28     1.45  8.73250
4    4  8.57 12.09  0.53 5.13 2.25 24.14 0.08681681  1.11     1.80 16.56500
5    5 12.09  9.12  0.23 8.26 3.34 20.33 0.08384901  0.79     1.31 21.47750
6    6 20.72 16.84  0.24 5.13 0.62  0.12 0.04156684  0.49     1.28 23.24841
    dec.THC dec.CBG       THC        CBG
1 0.0210000  0.0050 0.1454258 0.07076974
2 0.0440000  0.0086 0.2113313 0.09286962
3 0.0873250  0.0145 0.2999873 0.12070887
4 0.1656500  0.0180 0.4191687 0.13456987
5 0.2147750  0.0131 0.4818713 0.11470661
6 0.2324841  0.0128 0.5031255 0.11337985</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">subset</span>(GG_mat, <span class="at">select =</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>, <span class="dv">14</span><span class="sc">:</span><span class="dv">15</span>))</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>GGcor <span class="ot">&lt;-</span><span class="fu">rcorr</span>(<span class="fu">as.matrix</span>(x))</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>GGcor</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      CBCAS  GPPS THCAS  HDG5   OAC   PT1   PT4 CBDAS   THC   CBG
CBCAS  1.00  0.94 -0.87  0.64  0.11 -0.02 -0.63 -0.42  0.85  0.31
GPPS   0.94  1.00 -0.85  0.64  0.17  0.18 -0.68 -0.35  0.86  0.46
THCAS -0.87 -0.85  1.00 -0.86 -0.49 -0.36  0.46  0.30 -0.97 -0.56
HDG5   0.64  0.64 -0.86  1.00  0.70  0.66 -0.44 -0.43  0.79  0.61
OAC    0.11  0.17 -0.49  0.70  1.00  0.74 -0.25  0.23  0.48  0.39
PT1   -0.02  0.18 -0.36  0.66  0.74  1.00 -0.09 -0.08  0.35  0.72
PT4   -0.63 -0.68  0.46 -0.44 -0.25 -0.09  1.00  0.29 -0.41  0.12
CBDAS -0.42 -0.35  0.30 -0.43  0.23 -0.08  0.29  1.00 -0.13 -0.09
THC    0.85  0.86 -0.97  0.79  0.48  0.35 -0.41 -0.13  1.00  0.63
CBG    0.31  0.46 -0.56  0.61  0.39  0.72  0.12 -0.09  0.63  1.00

n= 7 


P
      CBCAS  GPPS   THCAS  HDG5   OAC    PT1    PT4    CBDAS  THC    CBG   
CBCAS        0.0015 0.0118 0.1243 0.8169 0.9629 0.1269 0.3465 0.0146 0.4954
GPPS  0.0015        0.0165 0.1194 0.7210 0.6935 0.0900 0.4349 0.0130 0.2934
THCAS 0.0118 0.0165        0.0135 0.2645 0.4215 0.3036 0.5076 0.0002 0.1895
HDG5  0.1243 0.1194 0.0135        0.0798 0.1043 0.3190 0.3364 0.0344 0.1438
OAC   0.8169 0.7210 0.2645 0.0798        0.0579 0.5845 0.6156 0.2722 0.3885
PT1   0.9629 0.6935 0.4215 0.1043 0.0579        0.8537 0.8727 0.4453 0.0707
PT4   0.1269 0.0900 0.3036 0.3190 0.5845 0.8537        0.5233 0.3618 0.7926
CBDAS 0.3465 0.4349 0.5076 0.3364 0.6156 0.8727 0.5233        0.7752 0.8453
THC   0.0146 0.0130 0.0002 0.0344 0.2722 0.4453 0.3618 0.7752        0.1260
CBG   0.4954 0.2934 0.1895 0.1438 0.3885 0.0707 0.7926 0.8453 0.1260       </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#tiff(file="GG_arcsin-matrix.tiff",</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     width=6, height=4, units="in", res=200)</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>GGcor<span class="sc">$</span>P[<span class="fu">is.na</span>(GGcor<span class="sc">$</span>P)]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(GGcor<span class="sc">$</span>r, <span class="co">#strength of correlation (info for size and color of circle)</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">method=</span><span class="st">"circle"</span>, <span class="co">#each correlation represented by a circle </span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">type=</span><span class="st">"upper"</span>, <span class="co">#orientation of plot (upper portion of the diagnonal)</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">p.mat=</span>GGcor<span class="sc">$</span>P, <span class="co">#p values for correlation, is the correlation a statistically significant, if so, then how significant? </span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">insig=</span><span class="st">"label_sig"</span>, <span class="co">#when there isn't a significant correlation </span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">pch.col=</span><span class="st">"white"</span>, <span class="co">#color of symbol </span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">sig.level =</span> <span class="fu">c</span>(.<span class="dv">001</span>,.<span class="dv">01</span>,.<span class="dv">05</span>), <span class="co">#p value cutoff points </span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">pch.cex=</span><span class="fl">1.25</span>, <span class="co">#size of symbol</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">tl.srt =</span> <span class="dv">45</span>) <span class="co">#tilt labels above graph at a 45˚ angle </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="script_tutorial_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">#dev.off()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="bar-plot-with-two-variables" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Bar plot with two variables</h1>
<p>Download data file that concerns types of trichomes and their densities in wild type and mutant tobacco leaves:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>urlfile5<span class="ot">=</span><span class="st">"https://raw.githubusercontent.com/apicellap/data/main/tri_count.csv"</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>tri_ct<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="fu">url</span>(urlfile5)) </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tri_ct)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  tissue tri_type count
1    ctl        1    62
2    ctl        1    32
3    ctl        1    54
4    ctl        2    54
5    ctl        2    20
6    ctl        2    33</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>tri_mean<span class="ot">&lt;-</span><span class="fu">summarise</span>(</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(tri_ct, tissue, tri_type, <span class="at">.groups =</span> <span class="cn">TRUE</span>), </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">obs =</span> <span class="fu">n</span>(), <span class="co">#counts the number of observations by group</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Mcount =</span> <span class="fu">mean</span>(count), <span class="co">#</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">SEcount =</span>(<span class="fu">sd</span>(count))<span class="sc">/</span><span class="fu">sqrt</span>(obs)) <span class="co">#calculate standard error for each group</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'tissue', 'tri_type'. You can override
using the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>tri_mean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 6
# Groups:   tissue, tri_type [4]
  tissue    tri_type .groups   obs Mcount SEcount
  &lt;chr&gt;        &lt;int&gt; &lt;lgl&gt;   &lt;int&gt;  &lt;dbl&gt;   &lt;dbl&gt;
1 ctl              1 TRUE        3   49.3    8.97
2 ctl              2 TRUE        3   35.7    9.91
3 oe_hdg5-8        1 TRUE        3  194.     3.48
4 oe_hdg5-8        2 TRUE        3   62.7   11.3 </code></pre>
</div>
</div>
<p>Data modifications and objects:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>tri_mean<span class="sc">$</span>tri_type <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(tri_mean<span class="sc">$</span>tri_type) <span class="co">#coerce tri_type variable into a factor </span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>type1 <span class="ot">&lt;-</span> <span class="fu">filter</span>(tri_ct, tri_type <span class="sc">==</span> <span class="st">"1"</span>) <span class="co">#subset the data </span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>type2 <span class="ot">&lt;-</span> <span class="fu">filter</span>(tri_ct, tri_type <span class="sc">==</span> <span class="st">"2"</span>)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>geneA <span class="ot">&lt;-</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">bold</span>(<span class="st">"wt"</span>))) </span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>geneB <span class="ot">&lt;-</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">bolditalic</span>(<span class="st">"OE-CsHDG5-8"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Plot the data in a bar plot (<code>geom_col()</code> is used):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="at">data =</span> tri_mean, </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">aes</span>(<span class="at">x =</span> tri_type, </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">y=</span>Mcount, </span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill=</span> tissue)) <span class="sc">+</span> <span class="co">#add color by tissue variable which refers to ctl (wt) or oe_hdg5-8 </span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.8</span>, <span class="at">position =</span> <span class="fu">position_dodge2</span>(<span class="dv">1</span>), <span class="at">show.legend =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="co">#another form of bar plot (col or column plot)</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">x =</span> tri_type, <span class="at">ymin =</span> Mcount <span class="sc">-</span> SEcount, <span class="at">ymax =</span> Mcount <span class="sc">+</span> SEcount, <span class="at">width=</span><span class="fl">0.1</span>),</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width=</span>.<span class="dv">8</span>), <span class="at">color=</span><span class="st">"black"</span>, <span class="at">size=</span><span class="fl">1.0</span>, <span class="at">linetype =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">name =</span> <span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(geneA, geneB)) <span class="sc">+</span>  <span class="co">#modify the labels titles in the legend </span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Trichome Number"</span>) <span class="sc">+</span> </span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span> </span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>),  <span class="co">#refers to data in the dataframe</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Type 1"</span>, <span class="st">"Type 2"</span>)) <span class="sc">+</span> <span class="co">#modify the labels on the x axis respectively for the limits </span></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">225</span>), <span class="co">#y axis range </span></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">225</span>, <span class="at">by =</span> <span class="dv">25</span>)) <span class="sc">+</span> <span class="co">#in this y axis range, increments increase by 25 </span></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.line.y.left =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>), <span class="co">#color of left axis line</span></span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.title.y.left =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">18</span>), <span class="co">#color, face, and size of y axis title</span></span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.text.y.left =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size =</span><span class="dv">18</span>), <span class="co">#color, face, and size of y axis values</span></span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">18</span>),  <span class="co">#color, face, and size of y axis values</span></span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="dv">1</span>), <span class="co">#size of tick on x and y axes</span></span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.ticks.length =</span> <span class="fu">unit</span>(<span class="sc">-</span><span class="fl">0.25</span>, <span class="st">"cm"</span>), <span class="co">#makes ticks go inside the plot </span></span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.title.x=</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>,<span class="at">size=</span><span class="dv">18</span>), <span class="co">#color, size of x axis title (not included)</span></span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">19</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>), </span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fl">12.5</span>, <span class="at">colour =</span><span class="st">"red"</span>),</span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>,<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">18</span>),</span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span><span class="st">"bold"</span>),</span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span><span class="st">"bold"</span>),</span>
<span id="cb57-31"><a href="#cb57-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill=</span><span class="cn">NA</span>, <span class="at">size=</span><span class="dv">1</span>),</span>
<span id="cb57-32"><a href="#cb57-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb57-33"><a href="#cb57-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.background =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> </span>
<span id="cb57-34"><a href="#cb57-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span><span class="fl">1.2</span>, <span class="at">y =</span> <span class="dv">210</span>, <span class="at">label =</span> <span class="st">"**"</span>, <span class="at">size =</span> <span class="dv">8</span>) </span>
<span id="cb57-35"><a href="#cb57-35" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="script_tutorial_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="data-cleaning" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Data cleaning</h1>
<p>Download data on Reactive oxygen species (ros) generation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>urlfile6<span class="ot">=</span><span class="st">"https://raw.githubusercontent.com/apicellap/data/main/nasty_ros.csv"</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>nas_ros<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="fu">url</span>(urlfile6)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>View dataframe:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(nas_ros,<span class="at">extensions =</span> <span class="st">'FixedColumns'</span>,</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">dom =</span> <span class="st">'t'</span>,</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">scrollX =</span> <span class="cn">TRUE</span>,</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fixedColumns =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div id="htmlwidget-2613d5f0d523dcba9227" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-2613d5f0d523dcba9227">{"x":{"filter":"none","vertical":false,"extensions":["FixedColumns"],"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47"],["cycle 1","cycle 2","cycle 3","cycle 4","cycle 5","cycle 6","cycle 7","cycle 8","cycle 9","cycle 10","cycle 11","cycle 12","cycle 13","cycle 14","cycle 15","cycle 16","cycle 17","cycle 18","cycle 19","cycle 20","cycle 21","cycle 22","cycle 23","cycle 24","cycle 25","cycle 26","cycle 27","cycle 28","cycle 29","cycle 30","cycle 31","cycle 32","cycle 33","cycle 34","cycle 35","cycle 36","cycle 37","cycle 38","cycle 39","cycle 40","cycle 41","cycle 42","cycle 43","cycle 44","cycle 45","cycle 46","cycle 47"],[32,80,43,15,16,38,39,70,112,149,187,1308,774,574,678,709,778,788,826,771,653,617,553,473,357,326,244,206,158,109,106,79,74,48,44,49,36,44,31,39,31,33,15,22,21,20,27],[9,3,5,2,4,0,1,5,6,9,19,7,12,17,12,11,7,3,8,8,5,12,3,7,11,10,3,6,2,4,5,4,5,0,3,7,1,5,4,3,4,8,6,2,2,5,6],[34,81,77,71,51,38,33,39,63,83,86,121,180,172,149,152,137,134,114,111,78,71,81,37,34,35,29,33,27,30,26,25,21,16,11,10,11,14,13,16,26,25,33,39,38,52,59],[27,60,73,57,50,39,48,50,88,115,124,103,79,82,89,99,70,83,65,67,71,51,45,33,44,31,22,26,29,24,18,15,19,15,6,18,16,13,7,9,5,9,19,7,14,12,8],[8,4,4,1,3,8,2,9,14,11,7,34,101,242,225,20,15,15,18,9,6,7,2,5,5,2,7,5,1,2,9,2,5,3,4,7,8,2,3,2,5,2,4,2,3,7,4],[9,13,15,11,4,20,46,93,138,191,240,278,304,320,295,307,319,241,246,213,180,124,135,89,114,93,54,33,28,23,18,20,19,17,8,18,12,11,11,13,15,12,8,11,14,8,10],[19.83333333,40.16666667,36.16666667,26.16666667,21.33333333,23.83333333,28.16666667,44.33333333,70.16666667,93,110.5,308.5,241.6666667,234.5,241.3333333,216.3333333,221,210.6666667,212.8333333,196.5,165.5,147,136.5,107.3333333,94.16666667,82.83333333,59.83333333,51.5,40.83333333,32,30.33333333,24.16666667,23.83333333,16.5,12.66666667,18.16666667,14,14.83333333,11.5,13.66666667,14.33333333,14.83333333,14.16666667,13.83333333,15.33333333,17.33333333,19],[12.44856083,37.61604268,33.24103889,30.10924553,23.09689734,17.11626906,21.32994765,34.30257522,52.90148076,73.62608233,92.18405502,498.7122417,279.3067609,198.5424388,235.8598454,264.4070095,295.9533747,295.9125997,312.6060887,291.5789773,247.2462335,234.1990606,210.1616045,181.6916802,134.5205065,123.3262611,92.03785453,76.73004627,58.8537736,39.40050761,37.80299812,28.30842042,25.61575036,17.02645001,15.61623087,15.91749562,11.88276062,15.03883861,10.31018914,13.55974434,11.79265308,11.72035267,10.83358974,14.38633611,13.26147302,17.79513042,21.26029163],[5.082103676,15.35668512,13.5705973,12.29204802,9.429268853,6.987687584,8.707914663,14.00396769,21.59693908,30.05772225,37.63398287,203.5984201,114.0265076,81.05461122,96.28937867,107.9437096,120.8224593,120.805813,127.6209013,119.036619,100.9378522,95.61136613,85.79811575,74.17531785,54.91776681,50.34773525,37.57429677,31.32491022,24.02695246,16.08518988,15.43300936,11.55686424,10.45758629,6.95101911,6.375299557,6.498290373,4.85111671,6.139580152,4.209117089,5.535742447,4.81433046,4.78481394,4.422794491,5.873197123,5.41397369,7.264831573,8.679477711],[6,8,2,30,115,257,464,747,1085,1330,1569,1861,1921,1967,1932,1726,1709,1567,1381,1233,1131,1008,826,684,576,534,478,384,391,289,259,201,182,131,133,99,90,96,73,92,65,64,56,65,71,56,63],[13,8,5,4,45,96,118,178,241,266,335,284,293,267,264,233,177,183,153,120,112,93,73,68,85,64,56,51,45,53,42,50,42,53,34,42,29,30,27,16,33,29,34,17,21,17,29],[23,34,32,15,15,58,123,127,143,211,206,222,240,216,233,252,211,237,227,205,174,156,116,109,96,76,53,42,29,21,24,15,15,11,9,19,18,18,16,15,18,9,15,13,20,17,6],[53,32,54,46,127,197,329,490,592,820,952,1141,1195,1118,1155,1036,979,897,776,639,534,403,251,169,110,80,54,40,35,20,29,28,6,13,18,12,16,6,11,8,11,11,10,7,13,9,12],[289,264,367,396,555,799,1066,1411,1694,1802,2001,3434,3054,2943,2663,2511,2356,2160,1814,1423,899,594,391,243,234,191,170,161,159,149,169,140,118,116,97,111,99,53,61,53,55,31,29,33,29,27,33],[184,292,313,444,594,943,1470,2591,3516,4116,4483,4326,4645,4571,4570,4621,4513,4202,3721,2911,2030,1307,833,415,186,129,105,75,60,67,60,48,35,24,19,17,13,22,23,23,21,18,25,13,15,12,11],[94.66666667,106.3333333,128.8333333,155.8333333,241.8333333,391.6666667,595,924,1211.833333,1424.166667,1591,1878,1891.333333,1847,1802.833333,1729.833333,1657.5,1541,1345.333333,1088.5,813.3333333,593.5,415,281.3333333,214.5,179,152.6666667,125.5,119.8333333,99.83333333,97.16666667,80.33333333,66.33333333,58,51.66666667,50,44.16666667,37.5,35.16666667,34.5,33.83333333,27,28.16666667,24.66666667,28.16666667,23,25.66666667],[115.8873016,133.736557,165.552912,205.671988,261.3674935,380.7023334,552.3940622,941.006695,1267.033609,1454.354347,1577.106845,1687.629699,1714.748106,1692.559836,1653.230464,1665.832335,1636.400898,1511.560386,1331.253645,1036.811603,716.5432762,481.4747138,339.8476129,232.0798713,186.3370602,180.1688097,165.7874141,134.5105944,141.2039896,103.9815689,95.68159001,73.61159329,69.13368692,53.11873492,50.99673192,44,39.46348523,32.65424934,25.55321245,32.26608126,21.71098032,20.24845673,16.26550542,21.63022577,21.71098032,17.28583235,21.20062892],[47.31079276,54.59772075,67.5866933,83.96523752,106.7028324,155.4210768,225.5139316,384.1643745,517.2643049,593.7376759,643.8511733,688.9719394,700.0429828,690.9846597,674.9285106,680.0732028,668.0578692,617.0919434,543.4820246,423.2765644,292.5275676,196.5612288,138.742207,94.74621071,76.07178627,73.55360857,67.68242838,54.9137202,57.64628734,42.45029773,39.06184555,30.05180712,28.2237095,21.68563272,20.81932863,17.96292478,16.11090038,13.33104147,10.4320553,13.17257252,8.863470602,8.266397845,6.640364782,8.830502691,8.863470602,7.056911506,8.655120514],[0,107,214,321,428,535,642,749,856,963,1070,1177,1284,1391,1498,1605,1712,1819,1926,2033,2140,2247,2354,2461,2568,2675,2782,2889,2996,3103,3210,3317,3424,3531,3638,3745,3852,3959,4066,4173,4280,4387,4494,4601,4708,4815,4922]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>X<\/th>\n      <th>X.1<\/th>\n      <th>X.2<\/th>\n      <th>X.3<\/th>\n      <th>X.4<\/th>\n      <th>X.5<\/th>\n      <th>X.6<\/th>\n      <th>wt<\/th>\n      <th>sd<\/th>\n      <th>se<\/th>\n      <th>X.7<\/th>\n      <th>X.8<\/th>\n      <th>X.9<\/th>\n      <th>X.10<\/th>\n      <th>X.11<\/th>\n      <th>X.12<\/th>\n      <th>oehdg5.8<\/th>\n      <th>sd.1<\/th>\n      <th>se.1<\/th>\n      <th>sec<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","scrollX":true,"fixedColumns":true,"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<ul>
<li>This dataset, which Gang Ma provided to me, has a wide format.
<ul>
<li>It also possesses characteristics of what is known as ‘untidy’ data.</li>
<li>There is nothing inherently wrong with this spreadsheet is set up.</li>
<li>However, R will be unable to read the data.</li>
<li>Therefore, it must be ‘cleaned’ and converted into a long format through multiple steps.</li>
<li>Additionally, it is highly recommended to not modify an original spreadsheet.
<ul>
<li>Instead, the spreadsheet can be reproduced in R and modified as an R dataframe.
<ul>
<li>R also has the benefit of automating many time consuming aspects of data cleaning.</li>
</ul></li>
</ul></li>
<li>The following code chunk is by no means a one-sized fits all approach and there is no one way to accomplish this.</li>
<li>I just try to keep things simple and choose the path of least resistance when I do anything in R.</li>
</ul></li>
</ul>
<p>Subset two elements of the wide-formatted data frame:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>wt <span class="ot">&lt;-</span> <span class="fu">select</span>(nas_ros, <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>,<span class="dv">20</span>) <span class="co">#isolate columns associated with wild type data in one dataframe </span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>trt <span class="ot">&lt;-</span> <span class="fu">select</span>(nas_ros, <span class="dv">1</span>,<span class="dv">11</span><span class="sc">:</span><span class="dv">16</span>,<span class="dv">20</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Clean the wt dataframe:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>wt <span class="ot">&lt;-</span> <span class="fu">gather</span>(wt, </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>             arb, <span class="co">#new variable that will encompass the former column names (this variable is not important going forward)</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>             ros, <span class="co">#new variable that will encompass the data under the former column names </span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>             <span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>, <span class="co">#perform this function in columns 2-7 </span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">na.rm =</span> <span class="cn">FALSE</span>, <span class="at">convert =</span> <span class="cn">FALSE</span>) </span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>wt <span class="ot">&lt;-</span> <span class="fu">select</span>(wt, X, sec, ros) <span class="co">#modify wt such that arb is not included in new version of dataframe  </span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(wt)[<span class="fu">names</span>(wt) <span class="sc">==</span> <span class="st">'X'</span>] <span class="ot">&lt;-</span> <span class="st">'cycle'</span> <span class="co">#changes name of variable</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(wt)[<span class="fu">names</span>(wt) <span class="sc">==</span> <span class="st">'wt'</span>] <span class="ot">&lt;-</span> <span class="st">'ros'</span> <span class="co">#changes name of variable</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>wt<span class="sc">$</span>treat <span class="ot">&lt;-</span> <span class="st">"wt"</span> <span class="co">#create new variable in dataframe and add the value in quotes to every observation</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wt) <span class="co">#display top six rows of data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    cycle sec ros treat
1 cycle 1   0  32    wt
2 cycle 2 107  80    wt
3 cycle 3 214  43    wt
4 cycle 4 321  15    wt
5 cycle 5 428  16    wt
6 cycle 6 535  38    wt</code></pre>
</div>
</div>
<p>Clean the trt dataframe:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>trt <span class="ot">&lt;-</span> <span class="fu">gather</span>(trt, arb, ros,<span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>,<span class="at">na.rm =</span> <span class="cn">FALSE</span>, <span class="at">convert =</span> <span class="cn">FALSE</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(trt)[<span class="fu">names</span>(trt) <span class="sc">==</span> <span class="st">'X'</span>] <span class="ot">&lt;-</span> <span class="st">'cycle'</span> <span class="co">#changes name of variable</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(trt)[<span class="fu">names</span>(trt) <span class="sc">==</span> <span class="st">'trt'</span>] <span class="ot">&lt;-</span> <span class="st">'ros'</span> <span class="co">#changes name of variable</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>trt <span class="ot">&lt;-</span> <span class="fu">select</span>(trt, cycle, ros, sec)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>trt<span class="sc">$</span>treat <span class="ot">&lt;-</span> <span class="st">"trt"</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(trt) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    cycle ros sec treat
1 cycle 1   6   0   trt
2 cycle 2   8 107   trt
3 cycle 3   2 214   trt
4 cycle 4  30 321   trt
5 cycle 5 115 428   trt
6 cycle 6 257 535   trt</code></pre>
</div>
</div>
<p>Combine the two cleaned dataframes into one:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>tidyros<span class="ot">&lt;-</span><span class="fu">rbind</span>(wt, trt) <span class="co">#combine the rows of two dataframes that share identical column names into new dataframe </span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>tidyros<span class="sc">$</span>sec <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(tidyros<span class="sc">$</span>sec) <span class="co">#coerce variable into being numeric </span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>tidyros <span class="ot">&lt;-</span> <span class="fu">filter</span>(tidyros, sec <span class="sc">&lt;=</span> <span class="dv">3424</span>) <span class="co">#filter dataframe to observations that occured before 3424 seconds</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>tidyros<span class="sc">$</span>min <span class="ot">&lt;-</span> tidyros<span class="sc">$</span>sec<span class="sc">/</span><span class="dv">60</span> <span class="co">#create new column that converts seconds to minutes </span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>tidyros <span class="ot">&lt;-</span>tidyros <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"min"</span>), round, <span class="dv">1</span>)) <span class="co">#modify observations in min column to have one decimal place</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>tidyros<span class="sc">$</span>min <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(tidyros<span class="sc">$</span>min) <span class="co">#coerce variable 'min' into being a factor </span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tidyros)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    cycle sec ros treat min
1 cycle 1   0  32    wt   0
2 cycle 2 107  80    wt 1.8
3 cycle 3 214  43    wt 3.6
4 cycle 4 321  15    wt 5.3
5 cycle 5 428  16    wt 7.1
6 cycle 6 535  38    wt 8.9</code></pre>
</div>
</div>
<p>Summarize the newly reformatted dataframe, tidyros:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>sum <span class="ot">&lt;-</span> tidyros <span class="sc">%&gt;%</span> </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cycle, treat, min, <span class="at">.groups =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="co">#define which groups' statistics will be calculated </span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">obs =</span> <span class="fu">n</span>(), <span class="co">#count the number of observations in each group </span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanT =</span> <span class="fu">mean</span>(ros), <span class="co">#calculate the mean for each group</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> (<span class="fu">sd</span>(ros)<span class="sc">/</span><span class="fu">sqrt</span>(obs))) <span class="co">#calculate the standard error of the mean for each group</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'cycle', 'treat', 'min'. You can override
using the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
# Groups:   cycle, treat, min [6]
  cycle    treat min   .groups   obs  meanT     se
  &lt;chr&gt;    &lt;chr&gt; &lt;fct&gt; &lt;lgl&gt;   &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1 cycle 1  trt   0     TRUE        6   94.7  47.3 
2 cycle 1  wt    0     TRUE        6   19.8   5.08
3 cycle 10 trt   16    TRUE        6 1424.  594.  
4 cycle 10 wt    16    TRUE        6   93    30.1 
5 cycle 11 trt   17.8  TRUE        6 1591   644.  
6 cycle 11 wt    17.8  TRUE        6  110.   37.6 </code></pre>
</div>
</div>
<p>Reformat summary statistics dataframe:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>sum <span class="ot">&lt;-</span> <span class="fu">select</span>(sum, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">5</span><span class="sc">:</span><span class="dv">7</span>) <span class="co">#select specific columns to go into new version of sum dataframe</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>sum<span class="sc">$</span>min <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(sum<span class="sc">$</span>min) <span class="co">#coerce min variable to be numeric </span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>sum <span class="ot">&lt;-</span> sum <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"min"</span>), round, <span class="dv">2</span>)) <span class="co">#round min variable observations to two digits </span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>sum <span class="ot">&lt;-</span> <span class="fu">arrange</span>(sum, <span class="at">by_group =</span> treat) <span class="co">#arrange table by treat variable </span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>sum<span class="sc">$</span>treat <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"trt"</span>,<span class="st">"OE-CsHDG5-8"</span>, sum<span class="sc">$</span>treat) <span class="co">#in treat variable, change observations from "trt" to "OE-CsHDG5-8"</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>sum<span class="sc">$</span>treat <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(sum<span class="sc">$</span>treat)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>sum <span class="ot">&lt;-</span> <span class="fu">mutate</span>(sum,<span class="at">treat =</span> <span class="fu">relevel</span>(treat, <span class="at">ref =</span> <span class="st">"wt"</span>)) <span class="co">#coerce wt into the reference level</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>sum<span class="sc">$</span>meanT <span class="ot">&lt;-</span> sum<span class="sc">$</span>meanT<span class="sc">/</span><span class="dv">100</span> <span class="co">#scale mean values down by 100 </span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>sum<span class="sc">$</span>se   <span class="ot">&lt;-</span> sum<span class="sc">$</span>se<span class="sc">/</span><span class="dv">100</span> <span class="co">#scale standard error of the mean down by 100</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
# Groups:   cycle, treat, min [6]
  cycle    treat         min   obs  meanT    se
  &lt;chr&gt;    &lt;fct&gt;       &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 cycle 1  OE-CsHDG5-8     1     6  0.947 0.473
2 cycle 10 OE-CsHDG5-8    10     6 14.2   5.94 
3 cycle 11 OE-CsHDG5-8    11     6 15.9   6.44 
4 cycle 12 OE-CsHDG5-8    12     6 18.8   6.89 
5 cycle 13 OE-CsHDG5-8    13     6 18.9   7.00 
6 cycle 14 OE-CsHDG5-8    14     6 18.5   6.91 </code></pre>
</div>
</div>
</section>
<section id="line-graph" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Line graph</h1>
<p>Create some objects for the figure:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>geneA <span class="ot">&lt;-</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">bold</span>(<span class="st">"wt"</span>)))</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>geneB <span class="ot">&lt;-</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">bolditalic</span>(<span class="st">"OE-CsHDG5-8"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>rosline <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sum, <span class="fu">aes</span>(<span class="at">x =</span> min, <span class="at">y =</span> meanT, <span class="at">color =</span> treat)) <span class="sc">+</span> </span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">x =</span> min, <span class="at">ymin =</span> meanT <span class="sc">-</span> se, <span class="at">ymax =</span> meanT <span class="sc">+</span> se)) <span class="sc">+</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span><span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>min, <span class="at">y =</span> meanT, <span class="at">color =</span> treat), <span class="at">size =</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"RLUs (x100)"</span>) <span class="sc">+</span> </span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Time (minutes)"</span>) <span class="sc">+</span> </span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"AtPep3"</span>) <span class="sc">+</span> </span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_continuous</span>(<span class="at">name =</span> <span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(geneA, geneB)) <span class="sc">+</span>  </span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">33</span>),</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">33</span>, <span class="at">by =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">28</span>),</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">28</span>, <span class="at">by =</span> <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_hue</span>(<span class="at">labels =</span> <span class="fu">c</span>(geneA, geneB)) <span class="sc">+</span> </span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.y.left =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>), </span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y.left =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">18</span>),</span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y.left =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size =</span><span class="dv">18</span>),</span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size =</span><span class="dv">14</span>, <span class="at">vjust=</span><span class="fl">0.5</span>),  <span class="co">#</span></span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="dv">1</span>), <span class="co">#size of tick on x and y axes</span></span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.length =</span> <span class="fu">unit</span>(<span class="sc">-</span><span class="fl">0.25</span>, <span class="st">"cm"</span>), <span class="co">#makes ticks go inside the plot </span></span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x=</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>,<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">18</span>, <span class="at">vjust =</span><span class="fl">0.6</span>), </span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">19</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>), </span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fl">12.5</span>, <span class="at">colour =</span><span class="st">"red"</span>),</span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>,<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">18</span>),</span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb74-28"><a href="#cb74-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span><span class="st">"bold"</span>),</span>
<span id="cb74-29"><a href="#cb74-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill=</span><span class="cn">NA</span>, <span class="at">size=</span><span class="dv">1</span>),</span>
<span id="cb74-30"><a href="#cb74-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb74-31"><a href="#cb74-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>()) </span>
<span id="cb74-32"><a href="#cb74-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-33"><a href="#cb74-33" aria-hidden="true" tabindex="-1"></a>rosline</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="script_tutorial_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="qpcr-data-analysis-in-r" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> qPCR data analysis in R</h1>
<p>Download raw qPCR Cq values:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>urlfile7<span class="ot">=</span><span class="st">"https://raw.githubusercontent.com/apicellap/data/main/hd1_tissuetype_raw.csv"</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>hd1<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="fu">url</span>(urlfile7)) </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(hd1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sample tissue target_gene housekeeping_gene target_mean_ct hk_mean_ct
1      1 flower         HD1         ubiquitin          30.34       30.6
2      5 flower         HD1         ubiquitin          30.13       30.8
3      9 flower         HD1         ubiquitin          30.71       31.0
4     13 flower         HD1         ubiquitin          29.62       30.3
5      2   leaf         HD1         ubiquitin          33.63       31.5
6      6   leaf         HD1         ubiquitin          33.61       31.6</code></pre>
</div>
</div>
<div class="callout-caution callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Expand to see my note about reproducing this example.
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>While this example is meant to be one that is reproducible, it is of particular importance with this example that the dataframe be set up in exactly the way I have laid it out for the following code to work correctly. See the dataframe at its location within my <a href="https://github.com/apicellap/data/blob/main/hd1_tissuetype_raw.csv">github repo</a>. Any changes to the the dataframe must be reflected in downstream code.</p>
</div>
</div>
</div>
<p>First step of qPCR calculations (for standard errors)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>ref_df<span class="ot">&lt;-</span><span class="fu">filter</span>(hd1, tissue <span class="sc">==</span> <span class="st">"root"</span>) <span class="co">#subset tissue by root (this is the arbitrary reference) to isolate and do calculations on its mean ct values </span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>Gmean_ct_target <span class="ot">&lt;-</span> <span class="fu">mean</span>(ref_df<span class="sc">$</span>target_mean_ct) <span class="co">#calculates means of the mean ct values in the target gene </span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>Gmean_ct_hk <span class="ot">&lt;-</span> <span class="fu">mean</span>(ref_df<span class="sc">$</span>hk_mean_ct)   <span class="co">#calculates means of the mean ct values in the housekeeping gene </span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>ref_val <span class="ot">&lt;-</span> Gmean_ct_target <span class="sc">-</span>Gmean_ct_hk     <span class="co">#calculate the reference ∆ct value</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>ref_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.176667</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>hd1<span class="sc">$</span>delta_ct <span class="ot">&lt;-</span> (hd1<span class="sc">$</span>target_mean_ct <span class="sc">-</span> hd1<span class="sc">$</span>hk_mean_ct) <span class="co">#create new column for  ∆ct to contain the newly calculated values </span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>hd1<span class="sc">$</span>delta_delta_ct <span class="ot">&lt;-</span> (hd1<span class="sc">$</span>delta_ct <span class="sc">-</span> ref_val)  <span class="co">#create new column for  ∆∆ct to contain the newly calculated values</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>hd1<span class="sc">$</span>expression <span class="ot">&lt;-</span> (<span class="dv">2</span><span class="sc">^-</span>hd1<span class="sc">$</span>delta_delta_ct) <span class="co">#calculate the expression data </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>View dataframe:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(hd1,<span class="at">extensions =</span> <span class="st">'FixedColumns'</span>,</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">dom =</span> <span class="st">'t'</span>,</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">scrollX =</span> <span class="cn">TRUE</span>,</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fixedColumns =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div id="htmlwidget-def6761c6a59e46cbc5f" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-def6761c6a59e46cbc5f">{"x":{"filter":"none","vertical":false,"extensions":["FixedColumns"],"data":[["1","2","3","4","5","6","7","8","9","10","11"],[1,5,9,13,2,6,10,14,4,12,16],["flower","flower","flower","flower","leaf","leaf","leaf","leaf","root","root","root"],["HD1","HD1","HD1","HD1","HD1","HD1","HD1","HD1","HD1","HD1","HD1"],["ubiquitin","ubiquitin","ubiquitin","ubiquitin","ubiquitin","ubiquitin","ubiquitin","ubiquitin","ubiquitin","ubiquitin","ubiquitin"],[30.34,30.13,30.71,29.62,33.63,33.61,34.62,34.31,35.6,36.33,37],[30.6,30.8,31,30.3,31.5,31.6,31.4,31.3,31.4,33,32],[-0.260000000000002,-0.670000000000002,-0.289999999999999,-0.68,2.13,2.01,3.22,3.01,4.2,3.33,5],[-4.43666666666667,-4.84666666666667,-4.46666666666667,-4.85666666666667,-2.04666666666667,-2.16666666666667,-0.956666666666671,-1.16666666666667,0.0233333333333334,-0.846666666666671,0.823333333333331],[21.655576386196,28.773457140422,22.1106060794844,28.9735923618671,4.13150286059755,4.48984819323751,1.94082046298709,2.24492409661875,0.983956653508112,1.79834107127638,0.565134694636579]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Sample<\/th>\n      <th>tissue<\/th>\n      <th>target_gene<\/th>\n      <th>housekeeping_gene<\/th>\n      <th>target_mean_ct<\/th>\n      <th>hk_mean_ct<\/th>\n      <th>delta_ct<\/th>\n      <th>delta_delta_ct<\/th>\n      <th>expression<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","scrollX":true,"fixedColumns":true,"columnDefs":[{"className":"dt-right","targets":[1,5,6,7,8,9]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>table1<span class="ot">&lt;-</span><span class="fu">summarise</span>(</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hd1, tissue), </span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">obs =</span> <span class="fu">n</span>(),</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">mean =</span> <span class="fu">mean</span>(expression), </span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">SE =</span>(<span class="fu">sd</span>(expression))<span class="sc">/</span><span class="fu">sqrt</span>(obs)) <span class="co">#multiple statistics can be calculated within summarise </span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>table1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  tissue   obs  mean    SE
  &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
1 flower     4 25.4  2.02 
2 leaf       4  3.20 0.647
3 root       3  1.12 0.362</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>tab2_exp<span class="ot">&lt;-</span><span class="fu">summarise</span>(</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hd1, tissue), </span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">target_mean =</span> <span class="fu">mean</span>(target_mean_ct), </span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">hk_mean =</span> <span class="fu">mean</span>(hk_mean_ct))</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>tab2_exp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  tissue target_mean hk_mean
  &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;
1 flower        30.2    30.7
2 leaf          34.0    31.4
3 root          36.3    32.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>tab2_exp<span class="sc">$</span>delta_ct <span class="ot">&lt;-</span> (tab2_exp<span class="sc">$</span>target_mean<span class="sc">-</span> tab2_exp<span class="sc">$</span>hk_mean)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>tab2_exp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  tissue target_mean hk_mean delta_ct
  &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
1 flower        30.2    30.7   -0.475
2 leaf          34.0    31.4    2.59 
3 root          36.3    32.1    4.18 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>ref_tab <span class="ot">&lt;-</span> <span class="fu">filter</span>(tab2_exp, tissue <span class="sc">==</span> <span class="st">"root"</span>)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>ref_val <span class="ot">&lt;-</span> ref_tab<span class="sc">$</span>delta_ct</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>ref_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.176667</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>tab2_exp<span class="sc">$</span>delta_delta_ct <span class="ot">&lt;-</span> (tab2_exp<span class="sc">$</span>delta_ct <span class="sc">-</span> ref_val )</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>tab2_exp<span class="sc">$</span>expression <span class="ot">&lt;-</span> (<span class="dv">2</span><span class="sc">^</span>(<span class="sc">-</span>tab2_exp<span class="sc">$</span>delta_delta_ct))</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>tab2_exp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 6
  tissue target_mean hk_mean delta_ct delta_delta_ct expression
  &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;          &lt;dbl&gt;      &lt;dbl&gt;
1 flower        30.2    30.7   -0.475          -4.65      25.1 
2 leaf          34.0    31.4    2.59           -1.58       3.00
3 root          36.3    32.1    4.18            0          1   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>complete_tab <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tab2_exp, table1<span class="sc">$</span>SE)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>complete_tab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  tissue target_mean  hk_mean  delta_ct delta_delta_ct expression table1.SE
1 flower     30.2000 30.67500 -0.475000      -4.651667  25.135712 2.0205138
2   leaf     34.0425 31.45000  2.592500      -1.584167   2.998346 0.6473727
3   root     36.3100 32.13333  4.176667       0.000000   1.000000 0.3620491</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>complete_tab <span class="ot">=</span> <span class="fu">rename</span>(complete_tab, <span class="at">se =</span> table1.SE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>T-tests:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>root_flower <span class="ot">&lt;-</span> <span class="fu">subset</span>(hd1, tissue <span class="sc">!=</span> <span class="st">"leaf"</span>)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>root_leaf <span class="ot">&lt;-</span> <span class="fu">subset</span>(hd1, tissue <span class="sc">!=</span> <span class="st">"flower"</span>)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>R_F<span class="ot">&lt;-</span><span class="fu">t.test</span>(expression <span class="sc">~</span> tissue, <span class="at">data =</span> root_flower)</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>R_F<span class="sc">$</span>p.value <span class="co">#print p-value for root vs flower t-test</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0009666249</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>gtools<span class="sc">::</span><span class="fu">stars.pval</span>(R_F<span class="sc">$</span>p.value) <span class="ot">-&gt;</span> R_Fp <span class="co">#object that encompasses p-value symbol</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>R_L<span class="ot">&lt;-</span><span class="fu">t.test</span>(expression <span class="sc">~</span> tissue, <span class="at">data =</span> root_leaf)</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>R_L<span class="sc">$</span>p.value <span class="co">#print p-value for root vs leaf t-test</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04206337</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>gtools<span class="sc">::</span><span class="fu">stars.pval</span>(R_L<span class="sc">$</span>p.value) <span class="ot">-&gt;</span> R_Lp </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Plot the data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>ggtitle<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="fu">bolditalic</span>(<span class="st">"HDG5"</span>)))</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>hd1.plot <span class="ot">&lt;-</span><span class="fu">ggplot</span>(complete_tab, <span class="fu">aes</span>(<span class="at">x =</span> tissue, <span class="at">y =</span> expression)) <span class="sc">+</span> </span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">'identity'</span>, <span class="at">fill =</span> <span class="st">"#82807E"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span><span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">x =</span> tissue, <span class="at">ymin =</span> expression <span class="sc">-</span> se, <span class="at">ymax =</span> expression <span class="sc">+</span> se, <span class="at">width=</span><span class="fl">0.1</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span> </span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Relative expression"</span>) <span class="sc">+</span> </span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(ggtitle<span class="fl">.1</span>) <span class="sc">+</span></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"root"</span>, <span class="st">"leaf"</span>, <span class="st">"flower"</span>), </span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Root"</span>,<span class="st">"Leaf"</span>, <span class="st">"Flower"</span>)) <span class="sc">+</span> </span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">32</span>),</span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">8</span>,<span class="dv">12</span>,<span class="dv">16</span>,<span class="dv">20</span>,<span class="dv">24</span>,<span class="dv">28</span>,<span class="dv">32</span>)) <span class="sc">+</span> </span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(</span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line.y.left =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"black"</span>), <span class="co">#color of left axis line</span></span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y.left =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">18</span>), <span class="co">#color, face, and size of y axis title</span></span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y.left =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size =</span><span class="dv">18</span>), <span class="co">#color, face, and size of y axis values</span></span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">18</span>),  <span class="co">#color, face, and size of y axis values</span></span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="dv">1</span>), <span class="co">#size of tick on x and y axes</span></span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.length =</span> <span class="fu">unit</span>(<span class="sc">-</span><span class="fl">0.25</span>, <span class="st">"cm"</span>), <span class="co">#makes ticks go inside the plot </span></span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x=</span><span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>,<span class="at">size=</span><span class="dv">18</span>), <span class="co">#color, size of x axis title (not included)</span></span>
<span id="cb99-22"><a href="#cb99-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">19</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>), </span>
<span id="cb99-23"><a href="#cb99-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fl">12.5</span>, <span class="at">colour =</span><span class="st">"red"</span>),</span>
<span id="cb99-24"><a href="#cb99-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb99-25"><a href="#cb99-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill=</span><span class="cn">NA</span>, <span class="at">size=</span><span class="dv">1</span>),</span>
<span id="cb99-26"><a href="#cb99-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># panel.grid.major = element_blank(),</span></span>
<span id="cb99-27"><a href="#cb99-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb99-28"><a href="#cb99-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> </span>
<span id="cb99-29"><a href="#cb99-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span><span class="dv">2</span>, <span class="at">y =</span> <span class="dv">5</span>, <span class="at">label =</span> R_Lp, <span class="at">size =</span> <span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb99-30"><a href="#cb99-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="dv">28</span>, <span class="at">label =</span> R_Fp, <span class="at">size =</span> <span class="dv">8</span>) </span>
<span id="cb99-31"><a href="#cb99-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-32"><a href="#cb99-32" aria-hidden="true" tabindex="-1"></a>hd1.plot </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="script_tutorial_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="session-information" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Session information</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.1.1 (2021-08-10)
Platform: aarch64-apple-darwin20 (64-bit)
Running under: macOS Monterey 12.4

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/lib/libRblas.0.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] Hmisc_4.7-0      Formula_1.2-4    survival_3.2-11  lattice_0.20-44 
 [5] corrplot_0.92    ggpubr_0.4.0     ggfortify_0.4.14 agricolae_1.3-5 
 [9] magrittr_2.0.3   forcats_0.5.1    stringr_1.4.0    purrr_0.3.4     
[13] readr_2.1.2      tidyr_1.2.0      tibble_3.1.6     tidyverse_1.3.1 
[17] ggplot2_3.3.6    dplyr_1.0.9     

loaded via a namespace (and not attached):
 [1] colorspace_2.0-3    ggsignif_0.6.3      ellipsis_0.3.2     
 [4] htmlTable_2.2.1     base64enc_0.1-3     fs_1.5.2           
 [7] rstudioapi_0.13     farver_2.1.0        DT_0.23            
[10] fansi_1.0.2         lubridate_1.8.0     xml2_1.3.3         
[13] splines_4.1.1       knitr_1.39          jsonlite_1.7.3     
[16] broom_1.0.0         cluster_2.1.2       dbplyr_2.1.1       
[19] png_0.1-7           shiny_1.7.1         compiler_4.1.1     
[22] httr_1.4.2          backports_1.2.1     assertthat_0.2.1   
[25] Matrix_1.3-4        fastmap_1.1.0       cli_3.2.0          
[28] later_1.3.0         htmltools_0.5.2     tools_4.1.1        
[31] gtable_0.3.0        glue_1.6.1          Rcpp_1.0.8         
[34] carData_3.0-4       cellranger_1.1.0    jquerylib_0.1.4    
[37] vctrs_0.4.1         nlme_3.1-152        crosstalk_1.2.0    
[40] xfun_0.31           rvest_1.0.2         mime_0.12          
[43] miniUI_0.1.1.1      lifecycle_1.0.1     gtools_3.9.2       
[46] rstatix_0.7.0       MASS_7.3-58         scales_1.1.1       
[49] hms_1.1.1           promises_1.2.0.1    RColorBrewer_1.1-2 
[52] yaml_2.2.1          gridExtra_2.3       sass_0.4.0         
[55] labelled_2.8.0      rpart_4.1-15        latticeExtra_0.6-29
[58] stringi_1.7.6       highr_0.9           klaR_0.6-15        
[61] AlgDesign_1.2.0     checkmate_2.0.0     rlang_1.0.2        
[64] pkgconfig_2.0.3     evaluate_0.15       htmlwidgets_1.5.4  
[67] labeling_0.4.2      tidyselect_1.1.2    R6_2.5.1           
[70] generics_0.1.2      combinat_0.0-8      DBI_1.1.2          
[73] pillar_1.7.0        haven_2.4.3         foreign_0.8-81     
[76] withr_2.4.3         abind_1.4-5         nnet_7.3-16        
[79] modelr_0.1.8        crayon_1.5.0        car_3.0-13         
[82] questionr_0.7.4     utf8_1.2.2          tzdb_0.1.2         
[85] rmarkdown_2.14      jpeg_0.1-9          grid_4.1.1         
[88] readxl_1.3.1        data.table_1.14.0   reprex_2.0.1       
[91] digest_0.6.29       xtable_1.8-4        httpuv_1.6.5       
[94] munsell_0.5.0       bslib_0.3.1        </code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>